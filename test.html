<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drain Current Graph</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: #f5f5f5;
        }

        .graph-container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .graph {
            width: 500px;
            height: 400px;
            position: relative;
            border-left: 2px solid #333;
            border-bottom: 2px solid #333;
            background: white;
        }

        /* Grid lines */
        .grid-line-h {
            position: absolute;
            width: 100%;
            height: 1px;
            background: #ddd;
            left: 0;
        }

        .grid-line-v {
            position: absolute;
            width: 1px;
            height: 100%;
            background: #ddd;
            top: 0;
        }

        /* Y-axis labels */
        .y-label {
            position: absolute;
            left: -30px;
            font-size: 12px;
            color: #333;
            transform: translateY(-6px);
        }

        /* X-axis labels */
        .x-label {
            position: absolute;
            bottom: -25px;
            font-size: 12px;
            color: #333;
            transform: translateX(-10px);
        }

        /* Axis titles */
        .y-title {
            position: absolute;
            left: -50px;
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }

        .x-title {
            position: absolute;
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }

        .figure-caption {
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            margin-top: 20px;
            color: #333;
        }

        /* Curve path */
        .curve-path {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .curve {
            stroke: #333;
            stroke-width: 3;
            fill: none;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: drawCurve 3s ease-in-out forwards;
        }

        @keyframes drawCurve {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* Animated dots along the curve */
        .data-point {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ff4444;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: showPoint 0.3s ease-in-out forwards;
        }

        .restart-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .restart-btn:hover {
            background: #0056b3;
        }

        @keyframes showPoint {
            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="graph-container">
        <div class="graph">
            <button class="restart-btn" onclick="restartAnimation()">Restart Animation</button>

            <!-- Grid lines -->
            <div class="grid-line-h" style="top: 0%"></div>
            <div class="grid-line-h" style="top: 20%"></div>
            <div class="grid-line-h" style="top: 40%"></div>
            <div class="grid-line-h" style="top: 60%"></div>
            <div class="grid-line-h" style="top: 80%"></div>

            <div class="grid-line-v" style="left: 20%"></div>
            <div class="grid-line-v" style="left: 40%"></div>
            <div class="grid-line-v" style="left: 60%"></div>
            <div class="grid-line-v" style="left: 80%"></div>
            <div class="grid-line-v" style="left: 100%"></div>

            <!-- Y-axis labels -->
            <div class="y-label" style="top: 0%">4</div>
            <div class="y-label" style="top: 20%">3</div>
            <div class="y-label" style="top: 40%">2</div>
            <div class="y-label" style="top: 60%">1</div>
            <div class="y-label" style="top: 80%">0</div>
            <div class="y-label" style="top: 100%">0</div>

            <!-- X-axis labels -->
            <div class="x-label" style="left: 0%">0</div>
            <div class="x-label" style="left: 20%">30</div>
            <div class="x-label" style="left: 40%">60</div>
            <div class="x-label" style="left: 60%">90</div>
            <div class="x-label" style="left: 80%">120</div>
            <div class="x-label" style="left: 100%">150</div>

            <!-- Axis titles -->
            <div class="y-title">ID Drain Current (A)</div>
            <div class="x-title">TJ Junction Temperature (°C)</div>

            <!-- SVG for the curve -->
            <div class="curve-path">
                <svg width="100%" height="100%" viewBox="0 0 500 400">
                    <path class="curve" d="M 0 60 Q 100 60 150 80 Q 200 100 250 140 Q 300 180 350 240 Q 400 320 500 380" />
                </svg>
            </div>

            <!-- Dynamic data points container -->
            <div id="dataPointsContainer"></div>
        </div>

        <div class="figure-caption">Figure 4 Drain Current</div>
    </div>

    <script>
        // Define your data points here - easily customizable!
        const dataPoints = [
            { temperature: 0, current: 3 },     // 0°C, 3A
            { temperature: 30, current: 3 },    // 30°C, 3A
            { temperature: 35.1, current: 2.9 },    // 30°C, 3A
            { temperature: 60, current: 2.6 },    // 60°C, 2.7A
            { temperature: 90, current: 1.8 },   // 90°C, 1.8A
            { temperature: 120, current: 1.0 },   // 120°C, 1.0A
            { temperature: 150, current: 0.1 }    // 150°C, 0.1A
        ];

        // Convert data values to graph coordinates (percentages)
        function convertToGraphCoords(temp, current) {
            const tempPercent = (temp / 150) * 100; // 0-150°C mapped to 0-100%
            const currentPercent = (1 - (current / 4)) * 100; // 0-4A mapped to 100-0% (inverted Y)
            return { x: tempPercent, y: currentPercent };
        }

        // Generate SVG path from data points
        function generateCurvePath(points) {
            if (points.length === 0) return '';

            let path = '';
            const coords = points.map(p => convertToGraphCoords(p.temperature, p.current));

            // Start the path
            path += `M ${coords[0].x * 5} ${coords[0].y * 4}`; // Scale to SVG viewBox

            // Create smooth curve using quadratic bezier curves
            for (let i = 1; i < coords.length; i++) {
                const prev = coords[i - 1];
                const curr = coords[i];

                if (i === 1) {
                    // First segment - simple line or quadratic
                    path += ` Q ${(prev.x + curr.x) / 2 * 5} ${prev.y * 4} ${curr.x * 5} ${curr.y * 4}`;
                } else {
                    // Smooth curves for subsequent points
                    path += ` T ${curr.x * 5} ${curr.y * 4}`;
                }
            }

            return path;
        }

        // Create and position data points dynamically
        function createDataPoints(points) {
            const container = document.getElementById('dataPointsContainer');
            container.innerHTML = ''; // Clear existing points

            points.forEach((point, index) => {
                const coords = convertToGraphCoords(point.temperature, point.current);
                const pointElement = document.createElement('div');
                pointElement.className = 'data-point';
                pointElement.style.left = coords.x + '%';
                pointElement.style.top = coords.y + '%';
                pointElement.style.animationDelay = (0.5 + index * 0.4) + 's';

                // Add tooltip with actual values
                pointElement.title = `${point.temperature}°C, ${point.current}A`;

                container.appendChild(pointElement);
            });
        }

        // Update the curve path
        function updateCurvePath(points) {
            const curve = document.querySelector('.curve');
            const newPath = generateCurvePath(points);
            curve.setAttribute('d', newPath);
        }

        // Initialize the graph with data
        function initializeGraph() {
            createDataPoints(dataPoints);
            updateCurvePath(dataPoints);
        }

        function restartAnimation() {
            // Remove and re-add the curve to restart animation
            const curve = document.querySelector('.curve');
            const newCurve = curve.cloneNode(true);
            curve.parentNode.replaceChild(newCurve, curve);

            // Reset data points
            const points = document.querySelectorAll('.data-point');
            points.forEach(point => {
                point.style.animation = 'none';
                point.offsetHeight; // Trigger reflow
                point.style.animation = null;
            });
        }

        // Function to update data points (call this to change data dynamically)
        function updateDataPoints(newDataPoints) {
            // Update the global data
            dataPoints.length = 0;
            dataPoints.push(...newDataPoints);

            // Recreate the graph elements
            createDataPoints(dataPoints);
            updateCurvePath(dataPoints);

            // Restart animation
            setTimeout(() => restartAnimation(), 100);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeGraph();
        });

        // Auto-restart every 8 seconds (increased time for more data points)
        setInterval(() => {
            restartAnimation();
        }, 8000);

        // Example: How to change data points dynamically
        // Uncomment and modify this section to test different data sets

        /*
        // Example 1: Different temperature curve
        setTimeout(() => {
            const newData = [
                { temperature: 0, current: 3.5 },
                { temperature: 30, current: 3.0 },
                { temperature: 60, current: 2.2 },
                { temperature: 90, current: 1.5 },
                { temperature: 120, current: 0.8 },
                { temperature: 150, current: 0.2 }
            ];
            updateDataPoints(newData);
        }, 10000);
        */

        /*
        // Example 2: More gradual decline
        setTimeout(() => {
            const newData = [
                { temperature: 0, current: 3.8 },
                { temperature: 25, current: 3.6 },
                { temperature: 50, current: 3.3 },
                { temperature: 75, current: 2.8 },
                { temperature: 100, current: 2.0 },
                { temperature: 125, current: 1.0 },
                { temperature: 150, current: 0.1 }
            ];
            updateDataPoints(newData);
        }, 20000);
        */
    </script>
</body>

</html>